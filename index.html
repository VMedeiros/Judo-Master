<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"
    />
    <meta
      name="description"
      content="Sistema de gerenciamento de técnicas de Judô por graduação de faixas"
    />
    <meta name="theme-color" content="#c8102e" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Judô Master" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="assets/icons/icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="assets/icons/icon-192x192.png"
    />
    <title>Judô Master - Gerenciamento de Técnicas</title>
    <!-- Preconnect para otimização de fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom scrollbar for a better look */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .dark ::-webkit-scrollbar-track {
        background: #2d3748;
      }
      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }
      .dark ::-webkit-scrollbar-thumb {
        background: #555;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
      .dark ::-webkit-scrollbar-thumb:hover {
        background: #333;
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "rxjs": "https://aistudiocdn.com/rxjs@^7.8.2?conditions=es2015",
          "rxjs/operators": "https://aistudiocdn.com/rxjs@^7.8.2/operators?conditions=es2015",
          "rxjs/ajax": "https://aistudiocdn.com/rxjs@^7.8.2/ajax?conditions=es2015",
          "rxjs/webSocket": "https://aistudiocdn.com/rxjs@^7.8.2/webSocket?conditions=es2015",
          "rxjs/testing": "https://aistudiocdn.com/rxjs@^7.8.2/testing?conditions=es2015",
          "rxjs/fetch": "https://aistudiocdn.com/rxjs@^7.8.2/fetch?conditions=es2015",
          "@angular/compiler": "https://next.esm.sh/@angular/compiler@^21.0.1?external=rxjs",
          "@angular/core": "https://next.esm.sh/@angular/core@^21.0.1?external=rxjs",
          "@angular/common": "https://next.esm.sh/@angular/common@^21.0.1?external=rxjs",
          "@angular/common/http": "https://next.esm.sh/@angular/common@^21.0.1/http?external=rxjs",
          "@angular/platform-browser": "https://next.esm.sh/@angular/platform-browser@^21.0.1?external=rxjs"
        }
      }
    </script>
    <script>
      // Registrar Service Worker para PWA
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("ngsw-worker.js")
            .then((reg) => console.log("Service Worker registrado:", reg))
            .catch((err) =>
              console.log("Erro ao registrar Service Worker:", err)
            );

          // Força reload quando o controlador do SW muda (novo deploy)
          let reloaded = false;
          navigator.serviceWorker.addEventListener("controllerchange", () => {
            if (reloaded) return;
            reloaded = true;
            // Recarrega para obter o index.html e bundles atualizados
            window.location.reload();
          });

          // Opcional: escuta mensagens do SW
          navigator.serviceWorker.addEventListener("message", (event) => {
            if (event.data?.type === "SW_ACTIVATED") {
              console.log("SW ativado:", event.data);
            }
          });
        });
      }
    </script>
  </head>
  <body class="bg-white dark:bg-gray-900 transition-colors duration-300">
    <app-root></app-root>
  </body>
</html>
